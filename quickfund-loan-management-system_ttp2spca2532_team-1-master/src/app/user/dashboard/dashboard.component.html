<div class="dashboard-wrapper container-fluid">
  <div class="row justify-content-center">
    <div class="col-lg-9 col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="mt-3">
          <h5 class="fw-bold">Welcome back, {{ user?.name }}!</h5>
          <p class="subtext text-muted">
            Manage your loans and track your financial progress
          </p>
        </div>
        <button
          class="btn m-0 d-flex align-items-center gradient text-white d-none d-sm-block me-1" routerLink="/user/apply-loan"
        >
          <i class="bi bi-plus-circle me-1"></i> Apply for Loan
        </button>
      </div>

      <div class="stat-cards row gx-3 gy-3 mb-3">
        <div class="col-md-4">
          <div class="stat-card border-left-blue">
            <div
              class="stat-title d-flex justify-content-between align-items-start" 
            >
              <span>Active Loans</span>
              <i class="bi bi-credit-card icon-primary"></i>
            </div>
            <div class="stat-value text-primary fw-bold">
              {{ activeLoans.length }}
            </div>
            <div class="stat-subtext text-muted">loans currently active</div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="stat-card border-left-green">
            <div
              class="stat-title d-flex justify-content-between align-items-start"
            >
              <span>Total Repaid</span>
              <i class="bi bi-graph-up-arrow icon-green"></i>
            </div>
            <div class="stat-value text-green fw-bold">
              ₹{{ totalRepaid | number }}
            </div>
            <div class="stat-subtext text-muted">across all loans</div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="stat-card border-left-orange">
            <div
              class="stat-title d-flex justify-content-between align-items-start"
            >
              <span>Outstanding Balance</span>
              <i class="bi bi-currency-dollar icon-orange"></i>
            </div>
            <div class="stat-value text-orange fw-bold">
              ₹{{ outstandingBalance | number }}
            </div>
            <div class="stat-subtext text-muted">remaining to pay</div>
          </div>
        </div>
      </div>

      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <div
            class="card action-card d-flex flex-row align-items-center"
            style="cursor: pointer"
            routerLink="/user/apply-loan"
          >
            <div class="icon-box plus">
              <i class="bi bi-plus-circle fs-5 fw-bold"></i>
            </div>
            <div class="ps-3">
              <p class="fw-bold mt-3 mb-1">Apply for Loan</p>
              <p class="small text-muted">Submit a new loan application</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div
            class="card action-card d-flex flex-row align-items-center"
            style="cursor: pointer"
            routerLink="/user/repayment"
          >
            <div class="icon-box repeat fs-5 fw-bold">
              <i class="bi bi-repeat"></i>
            </div>
            <div class="ps-3">
              <p class="fw-bold mt-3 mb-1">Make Repayment</p>
              <p class="small text-muted">Pay towards your active loans</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div
            class="card action-card d-flex flex-row align-items-center p-1"
            style="cursor: pointer"
            routerLink="/user/history"
          >
            <div class="icon-box clock fs-5 fw-bold">
              <i class="bi bi-clock-history"></i>
            </div>
            <div class="ps-3">
              <p class="fw-bold mt-3 mb-1">View History</p>
              <p class="small text-muted">
                Check your loan and payment history
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="card recent-loans">
        <div class="card-body">
          <div class="d-flex align-items-center mb-1">
            <div>
              <div class="d-flex align-items-center">
                <i class="bi bi-calendar me-2"></i>
                <p class="mb-0 fw-bold">Recent Loans</p>
              </div>
              <p class="small text-muted mt-1">
                Your most recent loan applications and their status
              </p>
            </div>
          </div>

          <div
            class="recent-loan-card d-flex justify-content-between align-items-center rounded p-1 border"
          >
            <div class="d-flex align-items-center">
              <div class="icon-box me-3">
                <i class="bi bi-currency-dollar dollar p-2"></i>
              </div>
              <div>
                <p class="fw-bold mt-3 mb-1">{{ recentLoan?.purpose }}</p>
                <p class="small text-muted">
                  ₹{{ recentLoan?.amount | number }} •
                  {{ recentLoan?.duration }} months
                </p>
              </div>
            </div>
            <div>
              <span
                class="badge me-2"
                [ngClass]="
                  recentLoan?.status === 'Active'
                    ? 'bg-success'
                    : 'bg-secondary'
                "
              >
                {{ recentLoan?.status.toLowerCase() }}
              </span>
              <!-- <span class="ms-2 text-muted small">{{ recentLoanDate }}</span>  -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
