<div class="dashboard-wrapper container-fluid">
  <div class="row justify-content-center">
    <div class="col-lg-9 col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="mt-3">
          <h5 class="fw-bold">Welcome back, Admin!</h5>
          <p class="subtext text-muted">
            Overview of Loan Management and Performance
          </p>
        </div>
        <div class="d-flex">
          <button
            class="btn m-0 d-flex align-items-center gradient text-white d-none d-sm-block me-1"
            [routerLink]="'/admin/approve'"
          >
            <i class="bi bi-plus-circle me-1"></i> Loan Approvals
          </button>

          <button
            class="btn m-0 d-flex align-items-center bg-white text-dark p-2 px-4 d-none d-sm-block"
            [routerLink]="'/admin/reports'"
          >
            <i class="bi bi-clipboard2-data me-1"></i> View Reports
          </button>
        </div>
      </div>

      <div class="stat-cards row gx-3 gy-3 mb-3">
        <div class="col-md-4">
          <div class="stat-card border-left-blue">
            <div
              class="stat-title d-flex justify-content-between align-items-start"
            >
              <span>Total Loans</span>
              <i class="bi bi-credit-card icon-primary"></i>
            </div>
            <div class="stat-value text-primary fw-bold">{{ totalLoans }}</div>
            <div class="stat-subtext text-muted">All time Applications</div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="stat-card border-left-green">
            <div
              class="stat-title d-flex justify-content-between align-items-start"
            >
              <span>Total Amount</span>
              <i class="bi bi-currency-dollar icon-green"></i>
            </div>
            <div class="stat-value text-green fw-bold">
              {{ totalAmount | number }}
            </div>
            <div class="stat-subtext text-muted">Total loan disbursed</div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="stat-card border-left-orange">
            <div
              class="stat-title d-flex justify-content-between align-items-start"
            >
              <span>Total Repayments</span>
              <i class="bi bi-people icon-orange"></i>
            </div>
            <div class="stat-value text-orange fw-bold">
              {{ totalRepayments | number }}
            </div>
            <div class="stat-subtext text-muted">collected to date</div>
          </div>
        </div>

        <app-loan-purpose-chart></app-loan-purpose-chart>

        <div class="card">
          <div class="ms-3 mt-3">
            <h6 class="mb-0">Recent Activity</h6>
            <p class="stat-subtext">Latest loan applications and repayments</p>
          </div>
          <div class="card-body">
            <div
              class="recent-loan-card d-flex justify-content-between align-items-center rounded p-1 border mb-2"
              *ngFor="let recentLoan of loans | slice : 0 : 3"
            >
              <div class="d-flex align-items-center">
                <div class="icon-box me-3">
                  <i class="bi bi-credit-card icon-primary"></i>
                </div>
                <div>
                  <p class="fw-bold mt-3 mb-1">{{ recentLoan.purpose }}</p>
                  <p class="small text-muted">
                    ₹{{ recentLoan.amount | number }} •
                    {{ recentLoan.duration }} months
                  </p>
                </div>
              </div>
              <div>
                <span
                  class="badge me-2"
                  [ngClass]="{
                    'bg-success': recentLoan.status === 'Active',
                    'bg-warning text-dark': recentLoan.status === 'Pending',
                    'bg-danger': recentLoan.status === 'Rejected',
                    'bg-secondary': recentLoan.status === 'Closed'
                  }"
                >
                  {{ recentLoan.status }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
